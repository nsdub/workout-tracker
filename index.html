<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#09090b">
  <title>Protocol</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:opsz,wght@9..40,400;9..40,500;9..40,600;9..40,700&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }
    
    :root {
      --bg-primary: #09090b;
      --bg-secondary: #18181b;
      --bg-tertiary: #27272a;
      --bg-elevated: #1c1c1f;
      --accent: #22d3ee;
      --accent-dim: rgba(34, 211, 238, 0.15);
      --accent-glow: rgba(34, 211, 238, 0.4);
      --success: #4ade80;
      --text-primary: #fafafa;
      --text-secondary: #a1a1aa;
      --text-muted: #52525b;
      --border: rgba(255,255,255,0.08);
      --border-focus: rgba(34, 211, 238, 0.5);
    }
    
    html, body {
      height: 100%;
      overflow-x: hidden;
    }
    
    body {
      font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      line-height: 1.5;
      min-height: 100vh;
      min-height: 100dvh;
      -webkit-font-smoothing: antialiased;
    }
    
    input, textarea, button, select {
      font-family: inherit;
      outline: none;
      border: none;
      background: none;
    }
    
    input[type="number"]::-webkit-inner-spin-button,
    input[type="number"]::-webkit-outer-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }
    
    input[type="number"] {
      -moz-appearance: textfield;
    }
    
    /* App Shell */
    .app {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      min-height: 100dvh;
    }
    
    /* Header */
    .header {
      padding: 16px 20px 20px;
      background: linear-gradient(180deg, var(--bg-secondary) 0%, var(--bg-primary) 100%);
      border-bottom: 1px solid var(--border);
      position: sticky;
      top: 0;
      z-index: 100;
    }
    
    .header-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .logo {
      font-size: 20px;
      font-weight: 700;
      letter-spacing: -0.5px;
      background: linear-gradient(135deg, var(--text-primary) 0%, var(--text-secondary) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .phase-badge {
      font-family: 'DM Mono', monospace;
      font-size: 11px;
      font-weight: 500;
      color: var(--accent);
      background: var(--accent-dim);
      padding: 6px 12px;
      border-radius: 6px;
      letter-spacing: 0.5px;
    }
    
    .stats-row {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      margin-top: 20px;
    }
    
    .stat-card {
      background: var(--bg-elevated);
      border-radius: 12px;
      padding: 14px;
      text-align: center;
      border: 1px solid var(--border);
    }
    
    .stat-value {
      font-family: 'DM Mono', monospace;
      font-size: 22px;
      font-weight: 500;
      color: var(--text-primary);
      line-height: 1.2;
    }
    
    .stat-label {
      font-size: 11px;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-top: 4px;
    }
    
    /* Navigation */
    .nav {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      background: var(--bg-secondary);
      border-bottom: 1px solid var(--border);
      position: sticky;
      top: 118px;
      z-index: 99;
    }
    
    .nav-btn {
      padding: 16px 8px;
      color: var(--text-muted);
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
      position: relative;
      text-align: center;
    }
    
    .nav-btn::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 2px;
      background: var(--accent);
      transition: width 0.2s;
      border-radius: 2px 2px 0 0;
    }
    
    .nav-btn.active {
      color: var(--accent);
    }
    
    .nav-btn.active::after {
      width: 24px;
    }
    
    /* Content */
    .content {
      flex: 1;
      padding: 24px 20px;
      padding-bottom: 120px;
    }
    
    .view {
      display: none;
      animation: fadeIn 0.2s ease;
    }
    
    .view.active {
      display: block;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(8px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    /* Section */
    .section {
      margin-bottom: 28px;
    }
    
    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 14px;
    }
    
    .section-title {
      font-size: 12px;
      font-weight: 600;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .section-badge {
      font-family: 'DM Mono', monospace;
      font-size: 11px;
      color: var(--accent);
    }
    
    /* Form Elements */
    .form-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    
    .form-group label {
      display: block;
      font-size: 12px;
      font-weight: 500;
      color: var(--text-secondary);
      margin-bottom: 8px;
    }
    
    .input {
      width: 100%;
      padding: 14px 16px;
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 10px;
      color: var(--text-primary);
      font-size: 16px;
      transition: all 0.2s;
    }
    
    .input::placeholder {
      color: var(--text-muted);
    }
    
    .input:focus {
      border-color: var(--border-focus);
      box-shadow: 0 0 0 3px var(--accent-dim);
    }
    
    input[type="date"] {
      color-scheme: dark;
    }
    
    /* Workout Selector */
    .workout-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 8px;
    }
    
    .workout-chip {
      padding: 14px 8px;
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 10px;
      color: var(--text-secondary);
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.15s;
      text-align: center;
      min-height: 48px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .workout-chip:active {
      transform: scale(0.96);
    }
    
    .workout-chip.active {
      background: var(--accent);
      border-color: var(--accent);
      color: var(--bg-primary);
      box-shadow: 0 4px 20px var(--accent-glow);
    }
    
    /* Exercise Card */
    .exercise-card {
      background: var(--bg-secondary);
      border-radius: 14px;
      padding: 18px;
      margin-bottom: 12px;
      border: 1px solid var(--border);
    }
    
    .exercise-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 6px;
    }
    
    .exercise-name {
      font-size: 15px;
      font-weight: 600;
      color: var(--text-primary);
      line-height: 1.3;
      flex: 1;
      padding-right: 12px;
    }
    
    .exercise-target {
      font-family: 'DM Mono', monospace;
      font-size: 12px;
      color: var(--text-muted);
      white-space: nowrap;
    }
    
    .exercise-note {
      font-size: 12px;
      color: var(--accent);
      margin-bottom: 16px;
      line-height: 1.4;
    }
    
    .sets-row {
      display: grid;
      gap: 10px;
    }
    
    .set-col {
      text-align: center;
    }
    
    .set-num {
      font-family: 'DM Mono', monospace;
      font-size: 10px;
      color: var(--text-muted);
      margin-bottom: 8px;
      letter-spacing: 0.5px;
    }
    
    .set-input-group {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }
    
    .set-input {
      width: 100%;
      padding: 12px 8px;
      background: var(--bg-primary);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text-primary);
      font-family: 'DM Mono', monospace;
      font-size: 16px;
      text-align: center;
      min-height: 48px;
      transition: all 0.15s;
    }
    
    .set-input::placeholder {
      color: var(--text-muted);
      font-size: 14px;
    }
    
    .set-input:focus {
      border-color: var(--border-focus);
      background: var(--bg-secondary);
    }
    
    .set-input.reps {
      font-size: 14px;
      min-height: 44px;
      padding: 10px 8px;
    }
    
    .input-label {
      font-size: 9px;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 4px;
    }
    
    /* Energy Slider */
    .energy-card {
      background: var(--bg-secondary);
      border-radius: 14px;
      padding: 20px;
      border: 1px solid var(--border);
    }
    
    .energy-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    
    .energy-label {
      font-size: 13px;
      font-weight: 500;
      color: var(--text-secondary);
    }
    
    .energy-value {
      font-family: 'DM Mono', monospace;
      font-size: 18px;
      font-weight: 600;
      color: var(--accent);
    }
    
    .slider-wrapper {
      position: relative;
      height: 48px;
      display: flex;
      align-items: center;
    }
    
    .slider-track {
      position: absolute;
      left: 0;
      right: 0;
      height: 6px;
      background: var(--bg-tertiary);
      border-radius: 3px;
      overflow: hidden;
    }
    
    .slider-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--accent), #a78bfa);
      border-radius: 3px;
      transition: width 0.1s ease-out;
    }
    
    .slider-input {
      position: relative;
      width: 100%;
      height: 48px;
      -webkit-appearance: none;
      appearance: none;
      background: transparent;
      cursor: pointer;
      z-index: 2;
    }
    
    .slider-input::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: var(--text-primary);
      border: 3px solid var(--accent);
      box-shadow: 0 2px 12px rgba(0,0,0,0.4);
      cursor: grab;
      transition: transform 0.15s;
    }
    
    .slider-input::-webkit-slider-thumb:active {
      cursor: grabbing;
      transform: scale(1.1);
    }
    
    .slider-input::-moz-range-thumb {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: var(--text-primary);
      border: 3px solid var(--accent);
      box-shadow: 0 2px 12px rgba(0,0,0,0.4);
      cursor: grab;
    }
    
    /* Primary Button */
    .btn-primary {
      width: 100%;
      padding: 18px;
      background: linear-gradient(135deg, var(--accent) 0%, #06b6d4 100%);
      border-radius: 12px;
      color: var(--bg-primary);
      font-size: 15px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.15s;
      box-shadow: 0 4px 24px var(--accent-glow);
      letter-spacing: 0.3px;
    }
    
    .btn-primary:active {
      transform: scale(0.98);
      box-shadow: 0 2px 12px var(--accent-glow);
    }
    
    /* Modal */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.8);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      display: none;
      align-items: flex-end;
      justify-content: center;
      z-index: 1000;
      padding: 20px;
    }
    
    .modal-overlay.active {
      display: flex;
    }
    
    .modal {
      background: var(--bg-secondary);
      border-radius: 20px 20px 24px 24px;
      padding: 28px 24px 32px;
      width: 100%;
      max-width: 400px;
      max-height: 85vh;
      overflow-y: auto;
      border: 1px solid var(--border);
      animation: slideUp 0.3s ease;
    }
    
    @keyframes slideUp {
      from { opacity: 0; transform: translateY(24px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .modal-icon {
      width: 56px;
      height: 56px;
      background: linear-gradient(135deg, var(--success), #22c55e);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 20px;
      box-shadow: 0 4px 20px rgba(74, 222, 128, 0.3);
    }
    
    .modal-icon svg {
      width: 28px;
      height: 28px;
      color: var(--bg-primary);
    }
    
    .modal-title {
      font-size: 22px;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 6px;
    }
    
    .modal-subtitle {
      font-size: 14px;
      color: var(--text-secondary);
      margin-bottom: 20px;
      line-height: 1.5;
    }
    
    .modal-code {
      background: var(--bg-primary);
      padding: 16px;
      border-radius: 12px;
      font-family: 'DM Mono', monospace;
      font-size: 12px;
      color: var(--text-secondary);
      overflow-x: auto;
      max-height: 200px;
      overflow-y: auto;
      margin-bottom: 20px;
      white-space: pre-wrap;
      word-break: break-word;
      line-height: 1.7;
      border: 1px solid var(--border);
    }
    
    .btn-copy {
      width: 100%;
      padding: 16px;
      background: var(--accent);
      border-radius: 12px;
      color: var(--bg-primary);
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      margin-bottom: 10px;
      transition: all 0.15s;
    }
    
    .btn-copy.copied {
      background: var(--success);
    }
    
    .btn-secondary {
      width: 100%;
      padding: 16px;
      background: var(--bg-tertiary);
      border-radius: 12px;
      color: var(--text-secondary);
      font-size: 15px;
      font-weight: 500;
      cursor: pointer;
    }
    
    /* Plan View */
    .volume-card {
      background: var(--bg-secondary);
      border-radius: 14px;
      padding: 20px;
      margin-bottom: 24px;
      border: 1px solid var(--border);
    }
    
    .volume-item {
      display: flex;
      align-items: center;
      padding: 10px 0;
    }
    
    .volume-muscle {
      width: 100px;
      font-size: 13px;
      color: var(--text-secondary);
    }
    
    .volume-bar-container {
      flex: 1;
      height: 8px;
      background: var(--bg-tertiary);
      border-radius: 4px;
      margin: 0 12px;
      overflow: hidden;
    }
    
    .volume-bar-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--accent), #a78bfa);
      border-radius: 4px;
    }
    
    .volume-count {
      font-family: 'DM Mono', monospace;
      font-size: 12px;
      color: var(--accent);
      width: 50px;
      text-align: right;
    }
    
    .plan-card {
      background: var(--bg-secondary);
      border-radius: 14px;
      margin-bottom: 10px;
      overflow: hidden;
      border: 1px solid var(--border);
    }
    
    .plan-header {
      padding: 16px 18px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: pointer;
      transition: background 0.15s;
    }
    
    .plan-header:active {
      background: var(--bg-tertiary);
    }
    
    .plan-title {
      font-weight: 600;
      color: var(--text-primary);
      font-size: 15px;
    }
    
    .plan-focus {
      font-size: 12px;
      color: var(--accent);
      font-weight: 500;
    }
    
    .plan-body {
      display: none;
      padding: 0 18px 16px;
      border-top: 1px solid var(--border);
    }
    
    .plan-body.open {
      display: block;
      padding-top: 14px;
    }
    
    .plan-exercise {
      display: flex;
      justify-content: space-between;
      padding: 10px 0;
      border-bottom: 1px solid var(--border);
      font-size: 13px;
    }
    
    .plan-exercise:last-child {
      border-bottom: none;
    }
    
    .plan-ex-name {
      color: var(--text-primary);
      flex: 1;
    }
    
    .plan-ex-sets {
      font-family: 'DM Mono', monospace;
      color: var(--text-muted);
      font-size: 12px;
    }
    
    /* History */
    .history-empty {
      text-align: center;
      padding: 80px 20px;
    }
    
    .history-empty-icon {
      font-size: 48px;
      margin-bottom: 16px;
      opacity: 0.4;
    }
    
    .history-empty-text {
      color: var(--text-muted);
      font-size: 15px;
    }
    
    .history-card {
      background: var(--bg-secondary);
      border-radius: 14px;
      padding: 18px;
      margin-bottom: 12px;
      border: 1px solid var(--border);
    }
    
    .history-top {
      display: flex;
      justify-content: space-between;
      margin-bottom: 14px;
    }
    
    .history-type {
      font-weight: 600;
      color: var(--text-primary);
      font-size: 16px;
    }
    
    .history-date {
      font-size: 13px;
      color: var(--text-muted);
      margin-top: 2px;
    }
    
    .history-meta {
      text-align: right;
    }
    
    .history-weight {
      font-family: 'DM Mono', monospace;
      font-size: 15px;
      font-weight: 600;
      color: var(--accent);
    }
    
    .history-energy {
      font-size: 12px;
      color: var(--text-muted);
      margin-top: 2px;
    }
    
    .history-exercises {
      font-size: 13px;
      color: var(--text-secondary);
      line-height: 1.8;
    }
    
    .history-ex-name {
      color: var(--text-primary);
      font-weight: 500;
    }
    
    .history-notes {
      font-size: 13px;
      color: var(--accent);
      margin-top: 14px;
      padding-top: 14px;
      border-top: 1px solid var(--border);
      font-style: italic;
    }
    
    .history-actions {
      display: flex;
      gap: 10px;
      margin-top: 14px;
    }
    
    .btn-action {
      flex: 1;
      padding: 12px;
      background: var(--bg-tertiary);
      border-radius: 10px;
      color: var(--text-secondary);
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      min-height: 48px;
      transition: all 0.15s;
    }
    
    .btn-action:active {
      background: var(--bg-primary);
    }
    
    .btn-delete {
      padding: 12px 18px;
      background: rgba(239, 68, 68, 0.15);
      border-radius: 10px;
      color: #f87171;
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      min-height: 48px;
    }
    
    /* Nutrition */
    .macro-hero {
      background: linear-gradient(135deg, #0f172a 0%, #1e1b4b 50%, #0f172a 100%);
      border-radius: 20px;
      padding: 28px 24px;
      margin-bottom: 28px;
      border: 1px solid rgba(139, 92, 246, 0.2);
      position: relative;
      overflow: hidden;
    }
    
    .macro-hero::before {
      content: '';
      position: absolute;
      top: -50%;
      right: -50%;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle, rgba(34, 211, 238, 0.1) 0%, transparent 70%);
    }
    
    .macro-hero-title {
      font-size: 11px;
      font-weight: 600;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 1.5px;
      margin-bottom: 20px;
      position: relative;
    }
    
    .macro-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
      position: relative;
    }
    
    .macro-item {
      text-align: center;
    }
    
    .macro-value {
      font-family: 'DM Mono', monospace;
      font-size: 32px;
      font-weight: 600;
      color: var(--text-primary);
      line-height: 1;
    }
    
    .macro-value.highlight {
      color: var(--accent);
    }
    
    .macro-unit {
      font-size: 14px;
      color: var(--text-muted);
    }
    
    .macro-label {
      font-size: 11px;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-top: 6px;
    }
    
    .meal-card {
      background: var(--bg-secondary);
      border-radius: 14px;
      padding: 18px;
      margin-bottom: 10px;
      border: 1px solid var(--border);
    }
    
    .meal-top {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
    }
    
    .meal-name {
      font-weight: 600;
      color: var(--text-primary);
      font-size: 15px;
    }
    
    .meal-time {
      font-family: 'DM Mono', monospace;
      font-size: 12px;
      color: var(--text-muted);
    }
    
    .meal-desc {
      font-size: 14px;
      color: var(--text-secondary);
      margin-bottom: 12px;
      line-height: 1.5;
    }
    
    .meal-macros {
      display: flex;
      gap: 16px;
      font-family: 'DM Mono', monospace;
      font-size: 12px;
    }
    
    .meal-cal {
      color: var(--text-muted);
    }
    
    .meal-protein {
      color: var(--accent);
      font-weight: 500;
    }
    
    .supp-card {
      background: var(--bg-secondary);
      border-radius: 14px;
      padding: 20px;
      margin-top: 24px;
      border: 1px solid var(--border);
    }
    
    .supp-title {
      font-size: 11px;
      font-weight: 600;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 16px;
    }
    
    .supp-item {
      display: flex;
      justify-content: space-between;
      padding: 12px 0;
      border-bottom: 1px solid var(--border);
      font-size: 14px;
    }
    
    .supp-item:last-child {
      border-bottom: none;
    }
    
    .supp-name {
      color: var(--text-primary);
    }
    
    .supp-dose {
      font-family: 'DM Mono', monospace;
      font-size: 12px;
      color: var(--text-muted);
    }
  </style>
</head>
<body>
  <div class="app">
    <header class="header">
      <div class="header-row">
        <div class="logo">Protocol</div>
        <div class="phase-badge">PHASE 1 â€¢ HYPERTROPHY</div>
      </div>
      <div class="stats-row">
        <div class="stat-card">
          <div class="stat-value" id="stat-workouts">0</div>
          <div class="stat-label">Workouts</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="stat-streak">0</div>
          <div class="stat-label">Streak</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="stat-weight">â€”</div>
          <div class="stat-label">Weight</div>
        </div>
      </div>
    </header>
    
    <nav class="nav">
      <button class="nav-btn active" data-view="log">Log</button>
      <button class="nav-btn" data-view="plan">Plan</button>
      <button class="nav-btn" data-view="history">History</button>
      <button class="nav-btn" data-view="nutrition">Nutrition</button>
    </nav>
    
    <main class="content">
      <!-- LOG VIEW -->
      <div id="log-view" class="view active">
        <section class="section">
          <div class="form-grid">
            <div class="form-group">
              <label>Date</label>
              <input type="date" id="workout-date" class="input">
            </div>
            <div class="form-group">
              <label>Bodyweight</label>
              <input type="number" inputmode="decimal" step="0.1" placeholder="215.0 lbs" id="bodyweight" class="input">
            </div>
          </div>
        </section>
        
        <section class="section">
          <div class="section-header">
            <span class="section-title">Workout</span>
          </div>
          <div class="workout-grid" id="workout-btns"></div>
        </section>
        
        <section class="section">
          <div class="section-header">
            <span class="section-title">Exercises</span>
            <span class="section-badge" id="workout-focus"></span>
          </div>
          <div id="exercises"></div>
        </section>
        
        <section class="section">
          <div class="energy-card">
            <div class="energy-header">
              <span class="energy-label">Energy Level</span>
              <span class="energy-value" id="energy-display">7/10</span>
            </div>
            <div class="slider-wrapper">
              <div class="slider-track">
                <div class="slider-fill" id="slider-fill" style="width: 70%"></div>
              </div>
              <input type="range" min="1" max="10" value="7" id="energy-slider" class="slider-input">
            </div>
          </div>
        </section>
        
        <section class="section">
          <div class="form-group">
            <label>Notes</label>
            <textarea id="notes" class="input" rows="3" placeholder="How did the session feel?"></textarea>
          </div>
        </section>
        
        <button class="btn-primary" id="save-btn">Save Workout</button>
      </div>
      
      <!-- PLAN VIEW -->
      <div id="plan-view" class="view">
        <section class="section">
          <div class="section-header">
            <span class="section-title">Weekly Volume</span>
            <span class="section-badge">Evidence-Based</span>
          </div>
          <div class="volume-card">
            <div class="volume-item">
              <span class="volume-muscle">Back</span>
              <div class="volume-bar-container"><div class="volume-bar-fill" style="width: 80%"></div></div>
              <span class="volume-count">16 sets</span>
            </div>
            <div class="volume-item">
              <span class="volume-muscle">Quads</span>
              <div class="volume-bar-container"><div class="volume-bar-fill" style="width: 60%"></div></div>
              <span class="volume-count">12 sets</span>
            </div>
            <div class="volume-item">
              <span class="volume-muscle">Triceps</span>
              <div class="volume-bar-container"><div class="volume-bar-fill" style="width: 60%"></div></div>
              <span class="volume-count">12 sets</span>
            </div>
            <div class="volume-item">
              <span class="volume-muscle">Calves</span>
              <div class="volume-bar-container"><div class="volume-bar-fill" style="width: 60%"></div></div>
              <span class="volume-count">12 sets</span>
            </div>
            <div class="volume-item">
              <span class="volume-muscle">Chest</span>
              <div class="volume-bar-container"><div class="volume-bar-fill" style="width: 50%"></div></div>
              <span class="volume-count">10 sets</span>
            </div>
            <div class="volume-item">
              <span class="volume-muscle">Biceps</span>
              <div class="volume-bar-container"><div class="volume-bar-fill" style="width: 50%"></div></div>
              <span class="volume-count">10 sets</span>
            </div>
            <div class="volume-item">
              <span class="volume-muscle">Side Delts</span>
              <div class="volume-bar-container"><div class="volume-bar-fill" style="width: 50%"></div></div>
              <span class="volume-count">10 sets</span>
            </div>
            <div class="volume-item">
              <span class="volume-muscle">Hams</span>
              <div class="volume-bar-container"><div class="volume-bar-fill" style="width: 50%"></div></div>
              <span class="volume-count">10 sets</span>
            </div>
            <div class="volume-item">
              <span class="volume-muscle">Rear Delts</span>
              <div class="volume-bar-container"><div class="volume-bar-fill" style="width: 40%"></div></div>
              <span class="volume-count">8 sets</span>
            </div>
            <div class="volume-item">
              <span class="volume-muscle">Glutes</span>
              <div class="volume-bar-container"><div class="volume-bar-fill" style="width: 40%"></div></div>
              <span class="volume-count">8 sets</span>
            </div>
          </div>
        </section>
        
        <section class="section">
          <div class="section-header">
            <span class="section-title">Workouts</span>
          </div>
          <div id="plan-cards"></div>
        </section>
      </div>
      
      <!-- HISTORY VIEW -->
      <div id="history-view" class="view"></div>
      
      <!-- NUTRITION VIEW -->
      <div id="nutrition-view" class="view">
        <div class="macro-hero">
          <div class="macro-hero-title">Daily Targets â€¢ Phase 1</div>
          <div class="macro-grid">
            <div class="macro-item">
              <div class="macro-value">3,200</div>
              <div class="macro-label">Calories</div>
            </div>
            <div class="macro-item">
              <div class="macro-value highlight">215<span class="macro-unit">g</span></div>
              <div class="macro-label">Protein</div>
            </div>
            <div class="macro-item">
              <div class="macro-value">375<span class="macro-unit">g</span></div>
              <div class="macro-label">Carbs</div>
            </div>
            <div class="macro-item">
              <div class="macro-value">95<span class="macro-unit">g</span></div>
              <div class="macro-label">Fat</div>
            </div>
          </div>
        </div>
        
        <section class="section">
          <div class="section-header">
            <span class="section-title">Meal Plan</span>
          </div>
          
          <div class="meal-card">
            <div class="meal-top">
              <span class="meal-name">Morning Shake</span>
              <span class="meal-time">07:00</span>
            </div>
            <div class="meal-desc">Whey isolate, oats, banana, almond butter, flax, spinach, cacao</div>
            <div class="meal-macros">
              <span class="meal-cal">650 cal</span>
              <span class="meal-protein">55g protein</span>
            </div>
          </div>
          
          <div class="meal-card">
            <div class="meal-top">
              <span class="meal-name">Mid-Morning</span>
              <span class="meal-time">09:30</span>
            </div>
            <div class="meal-desc">4 eggs, Ezekiel bread, sautÃ©ed vegetables</div>
            <div class="meal-macros">
              <span class="meal-cal">520 cal</span>
              <span class="meal-protein">30g protein</span>
            </div>
          </div>
          
          <div class="meal-card">
            <div class="meal-top">
              <span class="meal-name">Lunch</span>
              <span class="meal-time">12:30</span>
            </div>
            <div class="meal-desc">Lentils or black beans, brown rice, salad, avocado</div>
            <div class="meal-macros">
              <span class="meal-cal">750 cal</span>
              <span class="meal-protein">35g protein</span>
            </div>
          </div>
          
          <div class="meal-card">
            <div class="meal-top">
              <span class="meal-name">Pre-Workout</span>
              <span class="meal-time">15:00</span>
            </div>
            <div class="meal-desc">Greek yogurt, granola, berries, honey</div>
            <div class="meal-macros">
              <span class="meal-cal">480 cal</span>
              <span class="meal-protein">25g protein</span>
            </div>
          </div>
          
          <div class="meal-card">
            <div class="meal-top">
              <span class="meal-name">Post-Workout</span>
              <span class="meal-time">17:30</span>
            </div>
            <div class="meal-desc">Whey shake, banana, oats, almond milk</div>
            <div class="meal-macros">
              <span class="meal-cal">420 cal</span>
              <span class="meal-protein">40g protein</span>
            </div>
          </div>
          
          <div class="meal-card">
            <div class="meal-top">
              <span class="meal-name">Dinner</span>
              <span class="meal-time">19:30</span>
            </div>
            <div class="meal-desc">Tofu stir-fry, jasmine rice, mixed vegetables</div>
            <div class="meal-macros">
              <span class="meal-cal">550 cal</span>
              <span class="meal-protein">30g protein</span>
            </div>
          </div>
        </section>
        
        <div class="supp-card">
          <div class="supp-title">Supplements</div>
          <div class="supp-item">
            <span class="supp-name">Vitamin D3</span>
            <span class="supp-dose">5000 IU â€¢ AM</span>
          </div>
          <div class="supp-item">
            <span class="supp-name">Creatine</span>
            <span class="supp-dose">5g â€¢ Post</span>
          </div>
          <div class="supp-item">
            <span class="supp-name">Omega-3</span>
            <span class="supp-dose">2g â€¢ Meals</span>
          </div>
          <div class="supp-item">
            <span class="supp-name">Magnesium</span>
            <span class="supp-dose">400mg â€¢ PM</span>
          </div>
          <div class="supp-item">
            <span class="supp-name">Zinc</span>
            <span class="supp-dose">30mg â€¢ Dinner</span>
          </div>
          <div class="supp-item">
            <span class="supp-name">B12</span>
            <span class="supp-dose">1000mcg â€¢ AM</span>
          </div>
        </div>
      </div>
    </main>
  </div>
  
  <!-- Modal -->
  <div class="modal-overlay" id="modal">
    <div class="modal">
      <div class="modal-icon">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
        </svg>
      </div>
      <div class="modal-title">Workout Saved</div>
      <div class="modal-subtitle">Copy this summary and paste it to Claude for tracking and analysis.</div>
      <pre class="modal-code" id="export-text"></pre>
      <button class="btn-copy" id="copy-btn">Copy to Clipboard</button>
      <button class="btn-secondary" id="close-btn">Done</button>
    </div>
  </div>

  <script>
    const PLAN = {
      "Push A": {
        focus: "Chest",
        exercises: [
          { name: "Smith Incline Press", sets: 3, reps: "8-10", weight: 175, notes: "3s negative, stop at 90Â°" },
          { name: "Machine Chest Press", sets: 3, reps: "10-12", weight: 135, notes: "2s squeeze" },
          { name: "Cable Fly (Lowâ†’High)", sets: 2, reps: "12-15", weight: 10, notes: "Full stretch" },
          { name: "Cable Lateral Raise", sets: 3, reps: "12-15", weight: 10, notes: "Lean away" },
          { name: "Rear Delt Cable Fly", sets: 3, reps: "15", weight: 12.5, notes: "Slow eccentric" },
          { name: "Overhead Tricep Ext", sets: 3, reps: "12", weight: 47.5, notes: "" },
          { name: "Face Pulls", sets: 2, reps: "15-20", weight: 17.5, notes: "" }
        ]
      },
      "Pull A": {
        focus: "Width",
        exercises: [
          { name: "Deadlift", sets: 3, reps: "6", weight: 250, notes: "Full reset" },
          { name: "Lat Pulldown (Wide)", sets: 3, reps: "8-10", weight: 105, notes: "Full stretch" },
          { name: "Straight Arm Pulldown", sets: 2, reps: "12-15", weight: 30, notes: "Lat sweep" },
          { name: "Seated Cable Row", sets: 3, reps: "10-12", weight: 120, notes: "" },
          { name: "Incline DB Curl", sets: 3, reps: "10-12", weight: 30, notes: "Full stretch" },
          { name: "Hammer Curl", sets: 2, reps: "10-12", weight: 40, notes: "" },
          { name: "Face Pulls", sets: 2, reps: "15-20", weight: 17.5, notes: "" }
        ]
      },
      "Legs A": {
        focus: "Quads",
        exercises: [
          { name: "Smith Squat", sets: 4, reps: "8-10", weight: 135, notes: "From 125" },
          { name: "Leg Extension", sets: 3, reps: "12-15", weight: 150, notes: "2s squeeze" },
          { name: "Bulgarian Split Squat", sets: 3, reps: "10/leg", weight: 20, notes: "Deep" },
          { name: "Leg Curl", sets: 3, reps: "12-15", weight: 135, notes: "" },
          { name: "Seated Calf Raise", sets: 3, reps: "15-20", weight: 320, notes: "" },
          { name: "Standing Calf Raise", sets: 3, reps: "12-15", weight: 135, notes: "" }
        ]
      },
      "Push B": {
        focus: "Shoulders",
        exercises: [
          { name: "Smith OHP", sets: 3, reps: "6-8", weight: 120, notes: "" },
          { name: "DB Lateral Raise", sets: 3, reps: "12-15", weight: 15, notes: "" },
          { name: "Rear Delt Machine", sets: 3, reps: "15", weight: 71, notes: "" },
          { name: "Smith Incline Press", sets: 2, reps: "10", weight: 165, notes: "" },
          { name: "Cable Pushdown", sets: 3, reps: "12", weight: 27.5, notes: "" },
          { name: "Assisted Dips", sets: 2, reps: "10-12", weight: 27, notes: "" },
          { name: "Face Pulls", sets: 2, reps: "15-20", weight: 19.5, notes: "" }
        ]
      },
      "Pull B": {
        focus: "Thickness",
        exercises: [
          { name: "Rack Pulls", sets: 3, reps: "6-8", weight: 235, notes: "" },
          { name: "Smith Bent Over Row", sets: 3, reps: "8-10", weight: 155, notes: "" },
          { name: "Lat Pulldown (Close)", sets: 3, reps: "10-12", weight: 157.5, notes: "" },
          { name: "DB Shrug", sets: 3, reps: "12-15", weight: 65, notes: "2s hold" },
          { name: "DB Curl", sets: 3, reps: "10", weight: 40, notes: "" },
          { name: "Face Pulls", sets: 2, reps: "15-20", weight: 19.5, notes: "" }
        ]
      },
      "Legs B": {
        focus: "Posterior",
        exercises: [
          { name: "Romanian Deadlift", sets: 3, reps: "8-10", weight: 195, notes: "" },
          { name: "Leg Curl", sets: 3, reps: "10-12", weight: 142.5, notes: "" },
          { name: "Hip Thrust (Smith)", sets: 3, reps: "12-15", weight: 135, notes: "" },
          { name: "Smith Squat (Deep)", sets: 2, reps: "10", weight: 125, notes: "" },
          { name: "Seated Calf Raise", sets: 3, reps: "20", weight: 300, notes: "" },
          { name: "Standing Calf Raise", sets: 3, reps: "12-15", weight: 135, notes: "" }
        ]
      },
      "Rest": {
        focus: "Recovery",
        exercises: [
          { name: "Walk", sets: 1, reps: "20-30 min", weight: 0, notes: "" },
          { name: "Stretching", sets: 1, reps: "10-15 min", weight: 0, notes: "" },
          { name: "Foam Rolling", sets: 1, reps: "10 min", weight: 0, notes: "" }
        ]
      }
    };

    let selected = 'Push A';
    let exercises = [];
    let history = JSON.parse(localStorage.getItem('protocol-history') || '[]');

    const $ = id => document.getElementById(id);
    const dateInput = $('workout-date');
    const bwInput = $('bodyweight');
    const energySlider = $('energy-slider');
    const energyDisplay = $('energy-display');
    const sliderFill = $('slider-fill');
    const notesInput = $('notes');
    const workoutBtns = $('workout-btns');
    const workoutFocus = $('workout-focus');
    const exercisesEl = $('exercises');
    const modal = $('modal');
    const exportText = $('export-text');
    const copyBtn = $('copy-btn');

    dateInput.value = new Date().toISOString().split('T')[0];
    updateStats();

    // Energy slider
    energySlider.addEventListener('input', () => {
      const v = energySlider.value;
      energyDisplay.textContent = `${v}/10`;
      sliderFill.style.width = `${v * 10}%`;
    });

    // Navigation
    document.querySelectorAll('.nav-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
        btn.classList.add('active');
        $(btn.dataset.view + '-view').classList.add('active');
        if (btn.dataset.view === 'history') renderHistory();
        if (btn.dataset.view === 'plan') renderPlan();
      });
    });

    function renderWorkoutBtns() {
      workoutBtns.innerHTML = Object.keys(PLAN).map(w => 
        `<button class="workout-chip ${selected === w ? 'active' : ''}" data-w="${w}">${w}</button>`
      ).join('');
      workoutBtns.querySelectorAll('.workout-chip').forEach(btn => {
        btn.addEventListener('click', () => {
          selected = btn.dataset.w;
          renderWorkoutBtns();
          renderExercises();
        });
      });
    }

    function renderExercises() {
      const workout = PLAN[selected];
      workoutFocus.textContent = workout.focus;
      exercises = workout.exercises.map(ex => ({
        ...ex,
        sets_data: Array(ex.sets).fill().map(() => ({ weight: '', reps: '' }))
      }));

      exercisesEl.innerHTML = exercises.map((ex, i) => `
        <div class="exercise-card">
          <div class="exercise-header">
            <span class="exercise-name">${ex.name}</span>
            <span class="exercise-target">${ex.sets}Ã—${ex.reps}</span>
          </div>
          ${ex.notes ? `<div class="exercise-note">${ex.notes}</div>` : ''}
          <div class="sets-row" style="grid-template-columns: repeat(${ex.sets}, 1fr);">
            ${ex.sets_data.map((_, j) => `
              <div class="set-col">
                <div class="set-num">SET ${j + 1}</div>
                <div class="set-input-group">
                  <input type="number" inputmode="decimal" step="2.5" class="set-input" placeholder="${ex.weight}" data-ex="${i}" data-set="${j}" data-field="weight">
                  <input type="text" inputmode="text" class="set-input reps" placeholder="${ex.reps}" data-ex="${i}" data-set="${j}" data-field="reps">
                </div>
              </div>
            `).join('')}
          </div>
        </div>
      `).join('');

      exercisesEl.querySelectorAll('.set-input').forEach(input => {
        input.addEventListener('input', e => {
          const { ex, set, field } = e.target.dataset;
          exercises[ex].sets_data[set][field] = e.target.value;
        });
      });
    }

    function formatWorkout() {
      let out = `DATE: ${dateInput.value}\n`;
      out += `WORKOUT: ${selected}\n`;
      out += `BODYWEIGHT: ${bwInput.value || 'not recorded'}\n\n`;
      out += `EXERCISES:\n`;
      exercises.forEach(ex => {
        const sets = ex.sets_data.map((s, i) => {
          const w = s.weight || PLAN[selected].exercises.find(e => e.name === ex.name).weight;
          const r = s.reps || PLAN[selected].exercises.find(e => e.name === ex.name).reps;
          return `${w}x${r}`;
        }).join(', ');
        out += `${ex.name}: ${sets}\n`;
      });
      out += `\nENERGY: ${energySlider.value}/10\n`;
      if (notesInput.value) out += `NOTES: ${notesInput.value}\n`;
      return out;
    }

    $('save-btn').addEventListener('click', () => {
      const workout = {
        id: Date.now(),
        date: dateInput.value,
        type: selected,
        bodyweight: bwInput.value,
        energy: energySlider.value,
        notes: notesInput.value,
        exercises: exercises.map(ex => ({
          name: ex.name,
          sets: ex.sets_data.map((s, i) => ({
            weight: s.weight || PLAN[selected].exercises.find(e => e.name === ex.name).weight,
            reps: s.reps || PLAN[selected].exercises.find(e => e.name === ex.name).reps
          }))
        }))
      };
      history.unshift(workout);
      localStorage.setItem('protocol-history', JSON.stringify(history));
      updateStats();
      exportText.textContent = formatWorkout();
      modal.classList.add('active');
    });

    copyBtn.addEventListener('click', () => {
      navigator.clipboard.writeText(exportText.textContent).then(() => {
        copyBtn.textContent = 'âœ“ Copied';
        copyBtn.classList.add('copied');
        setTimeout(() => {
          copyBtn.textContent = 'Copy to Clipboard';
          copyBtn.classList.remove('copied');
        }, 2000);
      });
    });

    $('close-btn').addEventListener('click', () => modal.classList.remove('active'));

    function updateStats() {
      $('stat-workouts').textContent = history.length;
      let streak = 0;
      const today = new Date();
      for (let i = 0; i < 30; i++) {
        const d = new Date(today);
        d.setDate(d.getDate() - i);
        const ds = d.toISOString().split('T')[0];
        if (history.some(w => w.date === ds)) streak++;
        else if (i > 0) break;
      }
      $('stat-streak').textContent = streak;
      const last = history.find(w => w.bodyweight);
      $('stat-weight').textContent = last ? last.bodyweight : 'â€”';
    }

    function renderPlan() {
      $('plan-cards').innerHTML = Object.entries(PLAN).map(([name, w]) => `
        <div class="plan-card">
          <div class="plan-header" onclick="this.nextElementSibling.classList.toggle('open')">
            <span class="plan-title">${name}</span>
            <span class="plan-focus">${w.focus}</span>
          </div>
          <div class="plan-body">
            ${w.exercises.map(ex => `
              <div class="plan-exercise">
                <span class="plan-ex-name">${ex.name}</span>
                <span class="plan-ex-sets">${ex.sets}Ã—${ex.reps} @ ${ex.weight}</span>
              </div>
            `).join('')}
          </div>
        </div>
      `).join('');
    }

    function renderHistory() {
      const el = $('history-view');
      if (!history.length) {
        el.innerHTML = `<div class="history-empty"><div class="history-empty-icon">ðŸ“Š</div><div class="history-empty-text">No workouts logged yet</div></div>`;
        return;
      }
      el.innerHTML = history.map(w => `
        <div class="history-card">
          <div class="history-top">
            <div>
              <div class="history-type">${w.type}</div>
              <div class="history-date">${new Date(w.date).toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' })}</div>
            </div>
            <div class="history-meta">
              ${w.bodyweight ? `<div class="history-weight">${w.bodyweight} lbs</div>` : ''}
              <div class="history-energy">Energy: ${w.energy}/10</div>
            </div>
          </div>
          <div class="history-exercises">
            ${w.exercises.map(ex => `<div><span class="history-ex-name">${ex.name}:</span> ${ex.sets.map(s => `${s.weight}Ã—${s.reps}`).join(', ')}</div>`).join('')}
          </div>
          ${w.notes ? `<div class="history-notes">${w.notes}</div>` : ''}
          <div class="history-actions">
            <button class="btn-action" onclick="copyH(${w.id})">Copy</button>
            <button class="btn-delete" onclick="delH(${w.id})">Delete</button>
          </div>
        </div>
      `).join('');
    }

    window.copyH = id => {
      const w = history.find(h => h.id === id);
      const t = `DATE: ${w.date}\nWORKOUT: ${w.type}\nBODYWEIGHT: ${w.bodyweight || '-'}\n\nEXERCISES:\n${w.exercises.map(ex => `${ex.name}: ${ex.sets.map(s => `${s.weight}x${s.reps}`).join(', ')}`).join('\n')}\n\nENERGY: ${w.energy}/10${w.notes ? `\nNOTES: ${w.notes}` : ''}`;
      navigator.clipboard.writeText(t);
    };

    window.delH = id => {
      history = history.filter(h => h.id !== id);
      localStorage.setItem('protocol-history', JSON.stringify(history));
      updateStats();
      renderHistory();
    };

    renderWorkoutBtns();
    renderExercises();
    renderPlan();
  </script>
</body>
</html>
